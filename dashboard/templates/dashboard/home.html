{% extends "dashboard/base.html" %}
{% load rest_framework %}
{% load socialaccount %}
{% block content %}
    {% if not request.user.is_authenticated %}
    <div class="center">
        <div class="alert callout">
            To sign in to this dashboard you must create and verify a Firefox Account on the <a href="https://stable.dev.lcip.org/" target="_blank">Firefox Accounts stable development server</a>.<br>
        </div>
        <a class="large button expand" href="{% provider_login_url "fxa" %}">Sign in with <i class="fa fa-firefox"></i> Firefox Account</a>
    </div>
    {% else %}
        <h3>Domain Authorizations</h3>
        {% if domains %}
        <table>
            <thead>
                <tr>
                    <th>Domain</th>
                    <th>Status</th>
                    <th>Token</th>
                    <th>Validated</th>
                    <th>Expires</th>
                </tr>
            </thead>
            <tbody>
            {% for domain in domains %}
                <tr>
                    <td>{{ domain.domain }}</td>
                    <td>{{ domain.status }}</td>
                    <td>{{ domain.token }}</td>
                    <td>{{ domain.validated }}</td>
                    <td>{{ domain.expires }}</td>
            {% endfor %}
            </tbody>
        </table>
        {% else %}
            No domains found.
        {% endif %}
        <form action="{% url 'domainauthorization-list' %}" method="POST">
            {% csrf_token %}
            {% render_form domainauth_serializer %}
            <input type="submit" class="button" value="Add Domain">
        </form>


        <h3>Push Service Applications</h3>
        {% if push_apps %}
        <table>
            <thead>
                <tr>
                    <th>Name</th>
                    <th>JWS Key</th>
                </tr>
            </thead>
            <tbody>
            {% for app in push_apps %}
                <tr>
                    <td>{{ app.name }}</td>
                    <td>{{ app.jws_key }}</td>
            {% endfor %}
            </tbody>
        </table>
        {% else %}
            No push apps found.
        {% endif %}
        <form action="{% url 'pushapplication-list' %}" method="POST">
            {% csrf_token %}
            {% render_form pushapp_serializer %}
            <input type="submit" class="button" value="Add Push Application">
        </form>


    {% endif %}
</div>
{% endblock %}
